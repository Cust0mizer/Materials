Мы уже считали средний возраст клиентов мужского пола. Теперь сделаем то же для покупателей обоих полов: сгруппируем данные по полю `gender` и подсчитаем среднее значение поля `age`. Для группировки применяют оператор `GROUP BY`: его записывают после `FROM`, если условия нет, и после `WHERE` — если оно есть.

```SQL
SELECT gender,
       AVG(age)
FROM buyer
GROUP BY gender;
```

## Группировка с агрегацией и без.
Группировку можно комбинировать с агрегирующими функциями и фильтрацией. Усложним задачу — посчитаем средний возраст клиентов каждого пола для тех, у кого скидка больше 3%:

```SQL
SELECT gender,
       AVG(age)
FROM buyer
WHERE percent_of_discount > 3
GROUP BY gender;
```

В группировках можно указывать псевдонимы. Давайте подсчитаем среднюю цену товара для каждого месяца:
